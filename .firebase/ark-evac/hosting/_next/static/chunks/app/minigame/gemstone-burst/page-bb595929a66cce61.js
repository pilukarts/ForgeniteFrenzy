(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3098],{26871:function(e,t,r){Promise.resolve().then(r.bind(r,55655))},95137:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.379.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(78030).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},71976:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.379.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(78030).Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},63541:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.379.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(78030).Z)("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]])},66706:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.379.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(78030).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},55655:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return E}});var n=r(57437),l=r(2265),a=r(33593),i=r(82955),s=r(27385),o=r(89733),c=r(86763),u=r(34446),h=r(21513);/**
 * @license lucide-react v0.379.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let d=(0,r(78030).Z)("Bomb",[["circle",{cx:"11",cy:"13",r:"9",key:"hd149"}],["path",{d:"M14.35 4.65 16.3 2.7a2.41 2.41 0 0 1 3.4 0l1.6 1.6a2.4 2.4 0 0 1 0 3.4l-1.95 1.95",key:"jp4j1b"}],["path",{d:"m22 2-1.5 1.5",key:"ay92ug"}]]);var f=r(33907),m=r(63541),p=r(95137),x=r(71976),g=r(66706);let y=16*Math.sqrt(3),v=15*y+32,w=v-16,b=["#FF5A5A","#FFD700","#5AFF5A","#5A5AFF","#FF5AE4","#5AFFFF"];var M=()=>{let{addPoints:e}=(0,a.G$)(),{toast:t}=(0,c.pm)(),[r,i]=(0,l.useState)([]),[s,M]=(0,l.useState)(null),[j,k]=(0,l.useState)({color:b[0],special:null}),[E,C]=(0,l.useState)(0),[N,A]=(0,l.useState)(0),[F,S]=(0,l.useState)(0),[R,P]=(0,l.useState)(!1),z=(0,l.useRef)(0),Z=(0,l.useRef)(null),[L,q]=(0,l.useState)(!1),I=(0,l.useRef)(),B=(0,l.useRef)(!1);(0,l.useEffect)(()=>(q(!0),()=>{I.current&&cancelAnimationFrame(I.current)}),[]);let G=(0,l.useCallback)((e,t)=>({x:32*t+e%2*16+16,y:e*y+16}),[]),O=(0,l.useCallback)(()=>{z.current=0;let e=[];for(let t=0;t<6;t++){let r=11-t%2;for(let n=0;n<r;n++){let{x:r,y:l}=G(t,n);e.push({id:z.current++,row:t,col:n,x:r,y:l,color:b[Math.floor(Math.random()*b.length)],special:null})}}return e},[G]),_=(0,l.useCallback)(()=>{let e=[...new Set(r.filter(e=>null===e.special).map(e=>e.color))];return .1>Math.random()?.5>Math.random()?{color:"#333333",special:"bomb"}:{color:"white",special:"rainbow"}:e.length>0?{color:e[Math.floor(Math.random()*e.length)],special:null}:{color:b[Math.floor(Math.random()*b.length)],special:null}},[r]),D=(0,l.useCallback)(()=>{I.current&&cancelAnimationFrame(I.current);let e=O();i(e),M(null),A(0),P(!1),C(0),S(0),k(e.length>0?{color:e[Math.floor(Math.random()*e.length)].color,special:null}:{color:b[Math.floor(Math.random()*b.length)],special:null})},[O]);(0,l.useEffect)(()=>{L&&D()},[L,D]);let T=(0,l.useCallback)(()=>{if(s||R)return;let e=(E-90)*Math.PI/180;M({id:z.current++,x:184,y:w,color:j.color,special:j.special,vx:20*Math.cos(e),vy:20*Math.sin(e)}),S(e=>e+1)},[s,R,E,j]),U=(e,t)=>{let r=[];return t.forEach(t=>{e.id!==t.id&&35.2>Math.hypot(e.x-t.x,e.y-t.y)&&r.push(t)}),r},H=(e,t,r)=>{let n=[e],l=new Set([e.id]),a=[];for(;n.length>0;){let i=n.pop();if(i.color===r||"rainbow"===i.special||"rainbow"===e.special)for(let e of(a.push(i),U(i,t)))l.has(e.id)||(l.add(e.id),n.push(e))}return a},V=e=>{if(0===e.length)return[];let t=new Set,r=[];e.forEach(e=>{e.y-16<=0&&(r.push(e),t.add(e.id))});let n=0;for(;n<r.length;)for(let l of U(r[n++],e))t.has(l.id)||(t.add(l.id),r.push(l));return e.filter(e=>!t.has(e.id))},W=(0,l.useCallback)(n=>{M(null);let l=Math.round((n.y-16)/y),a=l%2==1?16:0,s=Math.round((n.x-a-16)/32),{x:o,y:c}=G(l,s),u={id:n.id,row:l,col:s,x:o,y:c,color:n.color,special:n.special},h=[...r,u],d=new Set,f=0,m=!1;if("bomb"===u.special)U(u,h).forEach(e=>d.add(e.id)),d.add(u.id),m=!0;else{let e=u.color,t=H(u,h,e);(t.length>=3||"rainbow"===u.special&&t.length>=2)&&(t.forEach(e=>d.add(e.id)),m=!0)}let p=h.filter(e=>!d.has(e.id));if(m){f+=10*d.size;let e=V(p);e.length>0&&(e.forEach(e=>d.add(e.id)),f+=50*e.length,t({title:"Nice Drop!",description:"+".concat(50*e.length," bonus points!")})),p=h.filter(e=>!d.has(e.id))}let x=m?p:h;0!==x.length||R||(t({title:"Board Cleared!",description:"+".concat(5e3.toLocaleString()," bonus points.")}),e(5e3),A(e=>e+5e3),x=O()),i(x),x.some(e=>e.y>=w-32)&&!R&&(P(!0),t({title:"Game Over!",description:"The gems reached the bottom!",variant:"destructive"})),f>0&&(A(e=>e+f),e(f)),k(_())},[r,G,e,t,_,R,O]),$=(0,l.useCallback)(()=>{let e=!1;i(t=>{let r=t.map(t=>{let r=t.row+1;return G(r,t.col).y>=w-32&&(e=!0),{...t,row:r}}).map(e=>({...e,...G(e.row,e.col)}));for(let e=0;e<11;e++){let{x:t,y:n}=G(0,e);r.push({id:z.current++,x:t,y:n,row:0,col:e,color:b[Math.floor(Math.random()*b.length)],special:null})}return r}),e&&!R&&(P(!0),t({title:"Game Over",description:"The gems reached the bottom!",variant:"destructive"}))},[R,G,t]);(0,l.useEffect)(()=>{F>0&&F%6==0&&$()},[F,$]),(0,l.useEffect)(()=>{if(!L||R){I.current&&cancelAnimationFrame(I.current);return}let e=()=>{if(s){let e=s.x+s.vx,t=s.y+s.vy,n=!1;if((e-16<0||e+16>368)&&M(e=>e?{...e,vx:-e.vx,x:e.x-e.vx}:null),t-16<=0)n=!0;else for(let l of r)if(32>Math.hypot(e-l.x,t-l.y)){n=!0;break}n?W({...s,x:e,y:t}):M(r=>r?{...r,x:e,y:t}:null)}I.current=requestAnimationFrame(e)};return I.current=requestAnimationFrame(e),()=>{I.current&&cancelAnimationFrame(I.current)}},[L,s,r,R,W]);let X=(0,l.useCallback)(()=>{let e=Z.current;if(!e)return;let t=e.getContext("2d");if(!t)return;t.clearRect(0,0,e.width,e.height),t.textAlign="center",t.textBaseline="middle";let n=e=>{if(t.beginPath(),t.arc(e.x,e.y,15,0,2*Math.PI),"rainbow"===e.special){let r=t.createRadialGradient(e.x,e.y,0,e.x,e.y,16);b.forEach((e,t)=>r.addColorStop(t/b.length,e)),t.fillStyle=r}else t.fillStyle=e.color;t.fill(),t.strokeStyle="rgba(0,0,0,0.2)",t.stroke(),"bomb"===e.special&&(t.fillStyle="white",t.font="bold 16px sans-serif",t.fillText("B",e.x,e.y))};if(L){r.forEach(n),s&&n(s);let e=(E-90)*Math.PI/180,l=184+60*Math.cos(e),a=w+60*Math.sin(e);t.beginPath(),t.moveTo(184,w),t.lineTo(l,a),t.strokeStyle="hsl(var(--primary))",t.lineWidth=4,t.stroke(),n({x:184,y:w,color:j.color,special:j.special})}},[L,r,s,E,j]);(0,l.useEffect)(()=>{let e;let t=()=>{X(),e=requestAnimationFrame(t)};return L&&Z.current&&(e=requestAnimationFrame(t)),()=>{e&&cancelAnimationFrame(e)}},[L,X]);let Y=e=>{R||C(t=>Math.max(-80,Math.min(80,t+("left"===e?-10:10))))},J=e=>{if(R)return;let t=Z.current;if(!t)return;let r=t.getBoundingClientRect(),n=e.clientX-r.left,l=180*Math.atan2(e.clientY-r.top-w,n-184)/Math.PI+90;C(l=Math.max(-80,Math.min(80,l))),B.current&&e.preventDefault()},K=()=>{!R&&B.current&&(B.current=!1,T())};return(0,l.useEffect)(()=>{if(!L)return;let e=e=>{if(!R)switch(e.preventDefault(),e.key){case"ArrowLeft":Y("left");break;case"ArrowRight":Y("right");break;case"ArrowUp":case" ":T()}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[L,R,T]),(0,n.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,n.jsxs)("div",{className:"text-lg font-headline text-primary",children:["Score: ",N.toLocaleString()]}),(0,n.jsxs)("div",{className:"relative bg-card rounded-lg border-2 border-primary shadow-lg",style:{width:368,height:v},children:[(0,n.jsx)(u.M,{children:R&&(0,n.jsxs)(h.E.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute inset-0 bg-black/70 flex flex-col items-center justify-center z-20 rounded-lg",children:[(0,n.jsx)("p",{className:"text-4xl font-headline text-primary mb-2",children:"Game Over"}),(0,n.jsx)(o.z,{onClick:D,variant:"secondary",children:"Play Again"})]})}),(0,n.jsx)("canvas",{ref:Z,width:368,height:v,className:"z-10 rounded-lg touch-none",onPointerDown:e=>{R||(B.current=!0,J(e))},onPointerMove:J,onPointerUp:K,onPointerLeave:K})]}),(0,n.jsxs)("div",{className:"flex items-center gap-4 mt-2 sm:hidden",children:[(0,n.jsx)(o.z,{onClick:()=>Y("left"),variant:"outline",size:"icon",className:"h-12 w-12",children:(0,n.jsx)(p.Z,{})}),(0,n.jsx)(o.z,{onClick:T,className:"h-16 w-24 text-lg font-bold",children:"bomb"===j.special?(0,n.jsx)(d,{className:"h-8 w-8 text-white"}):"rainbow"===j.special?(0,n.jsx)(f.Z,{className:"h-8 w-8 text-purple-400"}):(0,n.jsx)(m.Z,{className:"h-8 w-8"})}),(0,n.jsx)(o.z,{onClick:()=>Y("right"),variant:"outline",size:"icon",className:"h-12 w-12",children:(0,n.jsx)(x.Z,{})})]}),(0,n.jsxs)(o.z,{onClick:D,variant:"ghost",size:"sm",className:"mt-2",children:[(0,n.jsx)(g.Z,{className:"mr-2 h-4 w-4"})," Reset"]})]})},j=r(38272),k=r(87138),E=()=>{let{isLoading:e,isInitialSetupDone:t}=(0,a.G$)();return e?(0,n.jsx)(s.Z,{}):t?(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"container mx-auto px-2 sm:px-4 py-4 sm:py-6 h-full flex flex-col",children:[(0,n.jsxs)("header",{className:"mb-2 text-center relative",children:[(0,n.jsx)(k.default,{href:"/arcade",className:"absolute left-0 top-1/2 -translate-y-1/2",children:(0,n.jsx)(o.z,{variant:"ghost",size:"icon",children:(0,n.jsx)(p.Z,{className:"h-6 w-6"})})}),(0,n.jsxs)("h1",{className:"text-2xl sm:text-3xl font-headline text-primary flex items-center justify-center",children:[(0,n.jsx)(j.Z,{className:"mr-2 sm:mr-3 h-6 w-6 sm:h-8 sm:w-8"}),"Gemstone Burst"]}),(0,n.jsx)("p",{className:"text-sm sm:text-base text-muted-foreground mt-1",children:"Match 3 or more gems to clear them and earn points."})]}),(0,n.jsx)("div",{className:"flex-grow flex items-center justify-center",children:(0,n.jsx)(M,{})})]})}):(0,n.jsx)(i.Z,{})}},34446:function(e,t,r){"use strict";r.d(t,{M:function(){return g}});var n=r(57437),l=r(2265),a=r(5050),i=r(30458),s=r(67797),o=r(29791);class c extends l.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=this.props.sizeRef.current;e.height=t.offsetHeight||0,e.width=t.offsetWidth||0,e.top=t.offsetTop,e.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function u(e){let{children:t,isPresent:r}=e,a=(0,l.useId)(),i=(0,l.useRef)(null),s=(0,l.useRef)({width:0,height:0,top:0,left:0}),{nonce:u}=(0,l.useContext)(o._);return(0,l.useInsertionEffect)(()=>{let{width:e,height:t,top:n,left:l}=s.current;if(r||!i.current||!e||!t)return;i.current.dataset.motionPopId=a;let o=document.createElement("style");return u&&(o.nonce=u),document.head.appendChild(o),o.sheet&&o.sheet.insertRule('\n          [data-motion-pop-id="'.concat(a,'"] {\n            position: absolute !important;\n            width: ').concat(e,"px !important;\n            height: ").concat(t,"px !important;\n            top: ").concat(n,"px !important;\n            left: ").concat(l,"px !important;\n          }\n        ")),()=>{document.head.removeChild(o)}},[r]),(0,n.jsx)(c,{isPresent:r,childRef:i,sizeRef:s,children:l.cloneElement(t,{ref:i})})}let h=e=>{let{children:t,initial:r,isPresent:a,onExitComplete:o,custom:c,presenceAffectsLayout:h,mode:f}=e,m=(0,i.h)(d),p=(0,l.useId)(),x=(0,l.useCallback)(e=>{for(let t of(m.set(e,!0),m.values()))if(!t)return;o&&o()},[m,o]),g=(0,l.useMemo)(()=>({id:p,initial:r,isPresent:a,custom:c,onExitComplete:x,register:e=>(m.set(e,!1),()=>m.delete(e))}),h?[Math.random(),x]:[a,x]);return(0,l.useMemo)(()=>{m.forEach((e,t)=>m.set(t,!1))},[a]),l.useEffect(()=>{a||m.size||!o||o()},[a]),"popLayout"===f&&(t=(0,n.jsx)(u,{isPresent:a,children:t})),(0,n.jsx)(s.O.Provider,{value:g,children:t})};function d(){return new Map}var f=r(73241);let m=e=>e.key||"";function p(e){let t=[];return l.Children.forEach(e,e=>{(0,l.isValidElement)(e)&&t.push(e)}),t}var x=r(9033);let g=e=>{let{children:t,custom:r,initial:s=!0,onExitComplete:o,presenceAffectsLayout:c=!0,mode:u="sync",propagate:d=!1}=e,[g,y]=(0,f.oO)(d),v=(0,l.useMemo)(()=>p(t),[t]),w=d&&!g?[]:v.map(m),b=(0,l.useRef)(!0),M=(0,l.useRef)(v),j=(0,i.h)(()=>new Map),[k,E]=(0,l.useState)(v),[C,N]=(0,l.useState)(v);(0,x.L)(()=>{b.current=!1,M.current=v;for(let e=0;e<C.length;e++){let t=m(C[e]);w.includes(t)?j.delete(t):!0!==j.get(t)&&j.set(t,!1)}},[C,w.length,w.join("-")]);let A=[];if(v!==k){let e=[...v];for(let t=0;t<C.length;t++){let r=C[t],n=m(r);w.includes(n)||(e.splice(t,0,r),A.push(r))}"wait"===u&&A.length&&(e=A),N(p(e)),E(v);return}let{forceRender:F}=(0,l.useContext)(a.p);return(0,n.jsx)(n.Fragment,{children:C.map(e=>{let t=m(e),l=(!d||!!g)&&(v===C||w.includes(t));return(0,n.jsx)(h,{isPresent:l,initial:(!b.current||!!s)&&void 0,custom:l?void 0:r,presenceAffectsLayout:c,mode:u,onExitComplete:l?void 0:()=>{if(!j.has(t))return;j.set(t,!0);let e=!0;j.forEach(t=>{t||(e=!1)}),e&&(null==F||F(),N(M.current),d&&(null==y||y()),o&&o())},children:e},t)})})}}},function(e){e.O(0,[4358,7512,7304,7138,2955,2971,7023,1744],function(){return e(e.s=26871)}),_N_E=e.O()}]);